{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Transit Update - AssetoriX</title>
    <link href="{% static 'css/style.css' %}" rel="stylesheet">
    <link rel="icon" href="{% static 'favicon.ico' %}" type="image/x-icon">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        .nav-links {
            list-style: none;
            display: flex;
            gap: 20px;
            padding: 0;
            margin: 0;
        }

        .nav-links li {
            display: inline;
        }

        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background-color: #f5f5f5;
        }

        .dashboard-content {
            background-color: #ffffff;
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 90, 156, 0.1);
            text-align: left;
            max-width: 800px;
            margin: 30px auto;
        }

        .navbar {
            background-color: #004080;
            padding: 10px 20px;
        }

        .nav-links a {
            color: white;
            text-decoration: none;
            font-weight: bold;
        }

        .nav-links a:hover {
            text-decoration: underline;
        }

        footer {
            margin-top: 50px;
            text-align: center;
            font-size: 14px;
            color: #666;
        }

        label {
            font-weight: bold;
        }

        input, select {
            margin-bottom: 10px;
            padding: 6px;
            width: 100%;
            max-width: 300px;
        }

        button {
            padding: 8px 16px;
            background-color: #007bff;
            border: none;
            color: white;
            cursor: pointer;
            border-radius: 4px;
        }

        button:hover {
            background-color: #0056b3;
        }

        #result {
            margin-top: 20px;
        }
    </style>
</head>
<body>

<!-- Header and User Display -->
<div style="display: flex; justify-content: space-between; align-items: center;">
    <h1 style="margin: 0;">AssetoriX - Asset Management System</h1>
    <span>ðŸ‘¤ {{ user.username }}</span>
</div>

<!-- Navigation Bar -->


<!-- Main Content -->
<div class="dashboard-content">
    <h2>Update In-Transit Asset</h2>

    <label>Enter Serial Number:</label>
    <input type="text" id="serial_input">
    <button id="search_btn">Search</button>

    <div id="result" style="display:none;">
        <p><strong>Serial:</strong> <span id="serial_out"></span></p>
        <p><strong>Current Location:</strong> <span id="location_out"></span></p>
        <p><strong>Status:</strong> <span id="status_out"></span></p>

        <label>New Location:</label>
        <select id="new_location">
            <option value="">-- Select --</option>
            <option value="DIYAFAH">DIYAFAH</option>
            <option value="Akshay">Akshay</option>
            <option value="Nijin">Nijin</option>
            <option value="Jasim">Jasim</option>
        </select><br>

        <label>Working Status:</label>
        <select id="new_status">
            <option value="Working">Working</option>
            <option value="Needs Repair">Needs Repair</option>
      <option value="Scarp">Scarp</option>

        </select>

        <br><br>
        <button id="update_btn">Update</button>
    </div>
</div>

<!-- Footer -->
<footer>
    &copy; 2025 <a href="https://vsdevelopersnet.store/about" target="_blank">vsdevelopersnet.store</a>. All rights reserved.
</footer>

<!-- JavaScript -->
<script>
$(document).ready(function() {
    $('#search_btn').click(function() {
        let serial = $('#serial_input').val().trim();
        if (!serial) {
            alert("Enter serial number");
            return;
        }

        $.get('/inventory/get_transit_asset/', { serial: serial }, function(data) {
            $('#serial_out').text(data.serial_number);
            $('#location_out').text(data.current_location);
            $('#status_out').text(data.working_status);
            $('#result').show();
        }).fail(function() {
            alert("Asset not found or not in transit.");
            $('#result').hide();
        });
    });

    $('#update_btn').click(function() {
        const payload = {
            serial_number: $('#serial_out').text(),
            new_location: $('#new_location').val(),
            working_status: $('#new_status').val()
        };

        if (!payload.new_location || !payload.working_status) {
            alert("Please select location and status.");
            return;
        }

        $.ajax({
            url: '/inventory/get_transit_asset/',
            type: 'POST',
            contentType: 'application/json',
            data: JSON.stringify(payload),
            success: function() {
                alert("Asset updated successfully.");
                location.reload();
            },
            error: function() {
                alert("Update failed.");
            }
        });
    });
});
</script>

</body>
</html>
